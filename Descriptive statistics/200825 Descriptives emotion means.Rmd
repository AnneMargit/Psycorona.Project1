---
title: "200825 Descriptives emotion means"
author: "Anne Margit"
date: "08/25/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=F}
library(dplyr)
library(tidyverse)
library(stringr)
library(papaja)
library(ggpubr)
library(ggplot2)
```

Descriptive statistics
This dataset includes measurements from participants that (1) provided at least 3 measurements, (2) that are residents of the country they currently live in, (3) from countries with at least 20 participants, (4) provided data on age, combined with (5) imputed Stringency Index and (6) imputed emotion scores, (7) pooled age groups, and (8) emotion factor mean scores

```{r}
load("data_imputed_emomeans.Rdata")
```

How much missing data is left?
```{r, results = "hide", message=F}
#Missing data
missing.values <- data_imputed_emomeans %>%
  gather(key = "key", value = "val") %>%
  dplyr::mutate(is.missing = is.na(val)) %>%
  dplyr::group_by(key, is.missing) %>%
  dplyr::summarise(num.missing = n()) %>%
  dplyr::filter(is.missing==T) %>%
  dplyr::select(-is.missing) %>%
  dplyr::arrange(desc(num.missing))

```

```{r}
apa_table(missing.values, caption="Missing data")
```

Number of participants per country on baseline 
```{r, results = "hide", message=F}
data_imputed_emomeans$Country <- as.factor(data_imputed_emomeans$Country)

Country_N <- data_imputed_emomeans %>%
  filter(Time == "1") %>%
  group_by(Country) %>%
  summarise(NCountry = n())
```

```{r}
apa_table(Country_N, caption = "Number of participants per country on baseline")
```

Number of measurements per wave, emotion measurements per wave, and Stringency Index measurements per wave
```{r, results = "hide", message=F}
data_imputed_emomeans$Time <- as.factor(data_imputed_emomeans$Time)

Wave_N <- data_imputed_emomeans %>% 
group_by(Time)%>%
summarise(NWave = sum (!is.na(Date)), NAng= sum(!is.na(Ang)), NAnx= sum(!is.na(Anxiety)), NNerv= sum(!is.na(Nerv)), NDepr= sum(!is.na(Depr)), NExh= sum(!is.na(Exh)), NEnerg= sum(!is.na(Energ)),  NInsp= sum(!is.na(Insp)), NCalm= sum(!is.na(Calm)), NRel= sum(!is.na(Rel)), NStr = sum(!is.na(StringencyIndex)))
```

```{r}
apa_table(Wave_N, caption="Number of measurements per wave")
```

Number of participants per age group on baseline
```{r, results = "hide", message=F}
data_imputed_emomeans$Age <- as.factor(data_imputed_emomeans$Age)

Age_N <- data_imputed_emomeans %>%
  filter(Time=="1") %>%
  group_by(Age) %>%
  summarise(NAge = n())
```
```{r}
apa_table(Age_N, caption="Number of participants per age group on baseline")
```

Number of participants per pooled age group
```{r, results = "hide", message=F}
data_imputed_emomeans$Age_new <- as.factor(data_imputed_emomeans$Age_new)

Age_New <- data_imputed_emomeans %>%
  filter(Time=="1") %>%
  group_by(Age_new) %>%
  summarise(NAge = n())
```

```{r}
apa_table(Age_New, caption="Number of participants per pooled age group on baseline")
```

Number of males and females per age group on baseline     
```{r, results = "hide", message=F}
Age_Gender <- data_imputed_emomeans %>%
  filter(Time == "1") %>%
  select(Age, Gender) %>%
  group_by(Age, Gender) %>%
  count(Gender)
```
```{r}
apa_table(Age_Gender, caption="Number of males and females per age group on baseline", note="Age 1= 18-24; 2= 25-34; 3= 35-44; 4= 45-54; 5= 55-64; 6= 65-74; 7= 75-84; 8=85+; Gender 0= male; 1= female")
```

Number of males and females per pooled age group on baseline   
```{r, results = "hide", message=F}
Age_New_Gender <- data_imputed_emomeans %>%
  filter(Time == "1") %>%
  select(Age_new, Gender) %>%
  group_by(Age_new, Gender) %>%
  count(Gender)
```
 
```{r}
apa_table(Age_New_Gender, caption = "Number of males and females per pooled age group on baseline",
          note= "Age 0= 18-24; 1= 25-44; 2= 45-64; 3= 65+, Gender 0= male; 1= female")
```

Mean and SD, minimum and maximum of Stringency Index per country
```{r, results = "hide", message=F}
StringencySummary <- data_imputed_emomeans %>%
  group_by(Country)%>%
  summarize(mean = mean(StringencyIndex, na.rm=TRUE), sd = sd(StringencyIndex, na.rm=TRUE), 
            max = max(StringencyIndex, na.rm=TRUE), min = min(StringencyIndex, na.rm=TRUE))
```

```{r}
apa_table(StringencySummary, caption="Stringency Index per country")
```

Mean, SD, and median of combined emotion scores
```{r, results = "hide", message=F, warning =F}
emomeansN <- data_imputed_emomeans %>%
  group_by(Time) %>%
  summarise(across(NAA:PAD, .fns=list(Mean = mean, SD = sd, Median = median), na.rm=TRUE,
                   .names="{col}_{fn}"))
```

```{r}
apa_table(emomeansN, caption="Mean scores of mean emotion scores per wave")
```

Mean, SD, and median of emotion scores
```{r, results = "hide", message=F, warning =F}
emorawmeansN <- data_imputed_emomeans %>%
  group_by(Time) %>%
  summarise(across(Ang:Rel, .fns=list(Mean = mean, SD = sd, Median = median), na.rm=TRUE,
                   .names="{col}_{fn}"))
```

```{r}
apa_table(emorawmeansN, caption="Mean scores of raw emotion scores per wave")
```

Boxplots of mean emotion scores across time
```{r, results = "hide", message=F, warning=F}
theme_set(theme_classic())

gb_NAA <- ggplot(data_imputed_emomeans, aes(Age_new, NAA)) + geom_boxplot(varwidth=T, aes(fill= Age_new)) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

gb_NAD <- ggplot(data_imputed_emomeans, aes(Age_new, NAD)) + geom_boxplot(varwidth=T, aes(fill= Age_new)) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

gb_PAA <- ggplot(data_imputed_emomeans, aes(Age_new, PAA)) + geom_boxplot(varwidth=T, aes(fill= Age_new)) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

gb_PAD <- ggplot(data_imputed_emomeans, aes(Age_new, PAD)) + geom_boxplot(varwidth=T, aes(fill= Age_new)) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

gb_NA <- ggarrange(gb_NAA, gb_NAD, ncol = 2, nrow = 1, common.legend= TRUE, legend = "bottom")

gb_PA <- ggarrange(gb_PAA, gb_PAD, ncol = 2, nrow = 1, common.legend= TRUE, legend = "bottom")
```

```{r, warning=F}
gb_NA
gb_PA
```

Histograms of mean emotion scores 
```{r, results = "hide", message=F, warning=F}
g_NAA <- ggplot(data_imputed_emomeans, aes(x=NAA, fill=Age_new)) + geom_histogram(binwidth=1) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

g_NAD <- ggplot(data_imputed_emomeans, aes(x=NAD, fill=Age_new)) + geom_histogram(binwidth=1) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

g_PAA <- ggplot(data_imputed_emomeans, aes(x=PAA, fill=Age_new)) + geom_histogram(binwidth=1) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

g_PAD <- ggplot(data_imputed_emomeans, aes(x=PAD, fill=Age_new)) + geom_histogram(binwidth=1) + scale_fill_discrete(name="Age", labels = c("18-24", "25-44", "45-64", "65+"))

gh_NA <- ggarrange(g_NAA, g_NAD, ncol = 2, nrow = 1, common.legend= TRUE, legend = "bottom")

gh_PA <- ggarrange(g_PAA, g_PAD, ncol = 2, nrow = 1, common.legend= TRUE, legend = "bottom")
```

```{r, warning=F}
gh_NA
gh_PA
```

Stringency plots
```{r, results = "hide", message=F, warning=F}
data_imputed_emomeans$Country <- as.character(data_imputed_emomeans$Country)

data_graphs1 <- data_imputed_emomeans %>%
filter(Country == "Argentina" |  Country == "Australia" | Country == "Brazil" | Country == "Canada" | Country == "Chile" 
       | Country == "Croatia" | Country == "France" | Country == "Germany" )

data_graphs2 <- data_imputed_emomeans %>%
filter(Country == "Greece" | Country == "Hungary" | Country == "Indonesia" | Country == "Italy" | Country == "Japan" | Country == "Kazakhstan" | Country == "Kosovo" | Country == "Malaysia" )

data_graphs3 <- data_imputed_emomeans %>%
filter(Country == "Netherlands" | Country == "Peru" | Country == "Philippines" | Country == "Poland" | Country == "Serbia" | Country == "Romania" |
         Country == "Russia" | Country == "Saudi Arabia")

data_graphs4 <- data_imputed_emomeans %>%
filter(Country == "Singapore" | Country == "South Africa" | Country == "South Korea" | Country == "Spain" 
       | Country == "Turkey" | Country == "Ukraine" | Country == "United Kingdom" | Country == "United States" | Country == "Vietnam")

g_s1 <- ggplot(data_graphs1, aes(StringencyIndex, Country)) + geom_violin(aes(fill=factor(Country)))

g_s2 <- ggplot(data_graphs2, aes(StringencyIndex, Country)) + geom_violin(aes(fill=factor(Country)))

g_s3 <- ggplot(data_graphs3, aes(StringencyIndex, Country)) + geom_violin(aes(fill=factor(Country)))

g_s4 <- ggplot(data_graphs4, aes(StringencyIndex, Country)) + geom_violin(aes(fill=factor(Country)))

```

```{r, warning=F}
g_s1
g_s2
g_s3
g_s4
```

Stringency Index looks strange for some countries. Check the str. index for the USA, Brazil, and Canada over time:
```{r, results = "hide", message=F, warning=F}
g_usa <- ggplot(data_imputed_emomeans[which(data_imputed_emomeans$Country =="United States"), ], aes(Date, StringencyIndex)) + geom_point() + ylim(0,100)

g_brazil <- ggplot(data_imputed_emomeans[which(data_imputed_emomeans$Country =="Brazil"), ], aes(Date, StringencyIndex)) + geom_point() + ylim(0,100)

g_can <- ggplot(data_imputed_emomeans[which(data_imputed_emomeans$Country =="Canada"), ], aes(Date, StringencyIndex)) + geom_point() + ylim(0,100)
```

```{r, warning=F, message=F}
g_usa
g_brazil
g_can
```

